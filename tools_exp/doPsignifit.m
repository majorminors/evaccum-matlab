function [result,unscaledThreshold] = doPsignifit(data,threshold,neg)

if ~exist('data','var')
    threshold = 0.5;
end

if ~exist('data','var') % run demo
    data =    [...
    0.10,   45.0000,   90.0000;...
    0.15,   50.0000,   90.0000;...
    0.20,   44.0000,   90.0000;...
    0.25,   44.0000,   90.0000;...
    0.30,   52.0000,   90.0000;...
    0.35,   53.0000,   90.0000;...
    0.40,   62.0000,   90.0000;...
    0.45,   64.0000,   90.0000;...
    0.50,   76.0000,   90.0000;...
    0.60,   79.0000,   90.0000;...
    0.70,   88.0000,   90.0000;...
    0.80,   90.0000,   90.0000;...
    1.00,   90.0000,   90.0000];

end

options             = struct;

if exist('neg','var')
    options.sigmoidName = 'neg_gauss';
else
    options.sigmoidName = 'norm';
end
options.expType     = '2AFC';

result = psignifit(data,options);

unscaledThreshold = getThreshold(result,threshold,0); % this is broken---have to turn off unscaled to turn it on!

return
end